<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ARARAAZUL PRO ULTRA - SISTEMA INTEGRAL</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #00D4A0; --secondary: #0066FF; --danger: #FF3B5C; --warning: #FFB800; }
        body.dark { --bg: #04080F; --surface: #0D1526; --border: #1E2B45; --card: #131C31; --text: #E4EEFF; --text-muted: #4F6A8F; }
        body.light { --bg: #F0F4F8; --surface: #FFFFFF; --border: #D1D9E6; --card: #FFFFFF; --text: #1A202C; --text-muted: #718096; }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: var(--bg); color: var(--text); transition: 0.3s; min-height: 100vh; }

        header { padding: 15px 30px; background: var(--surface); display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid var(--primary); }
        .logo-box { display: flex; align-items: center; gap: 12px; }
        .logo-sq { width: 40px; height: 40px; background: linear-gradient(135deg, var(--primary), var(--secondary)); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: #fff; font-weight: 900; }

        .nav-bar { display: flex; justify-content: space-between; background: var(--surface); padding: 0 30px; border-bottom: 1px solid var(--border); }
        .nav-tabs { display: flex; gap: 10px; }
        .t-btn { padding: 15px 20px; border: none; background: transparent; color: var(--text-muted); cursor: pointer; font-weight: 700; font-size: 11px; text-transform: uppercase; border-bottom: 3px solid transparent; }
        .t-btn.active { color: var(--primary); border-bottom-color: var(--primary); }

        .metrics { display: grid; grid-template-columns: repeat(4, 1fr); background: var(--surface); border-bottom: 1px solid var(--border); padding: 15px 30px; gap: 15px; }
        .m-card { padding: 10px; border: 1px solid var(--border); border-radius: 8px; text-align: center; }
        .m-val { display: block; font-size: 20px; font-weight: 800; color: var(--primary); }
        .m-lbl { font-size: 9px; color: var(--text-muted); text-transform: uppercase; }

        .form { background: var(--surface); padding: 25px 30px; display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 12px; border-bottom: 1px solid var(--border); }
        .group label { display: block; font-size: 9px; font-weight: 800; color: var(--text-muted); margin-bottom: 5px; }
        .fi { width: 100%; padding: 10px; background: var(--bg); border: 1px solid var(--border); border-radius: 6px; color: var(--text); font-family: inherit; font-size: 12px; text-transform: uppercase; outline: none; }
        .btn-main { background: var(--primary); color: #000; border: none; border-radius: 6px; font-weight: 800; cursor: pointer; font-size: 10px; padding: 10px; text-transform: uppercase; align-self: flex-end; }

        .board { padding: 30px; display: grid; grid-template-columns: repeat(auto-fill, minmax(380px, 1fr)); gap: 25px; }
        .board.list-view { grid-template-columns: 1fr; }

        .leaf { background: var(--card); border-radius: 12px; padding: 25px; border-left: 6px solid var(--secondary); box-shadow: 0 8px 15px rgba(0,0,0,0.1); position: relative; display: flex; flex-direction: column; gap: 10px; }
        .leaf.urgent { border-left-color: var(--danger); animation: pulse 2s infinite; }
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(255, 59, 92, 0.4); } 70% { box-shadow: 0 0 0 10px rgba(255, 59, 92, 0); } 100% { box-shadow: 0 0 0 0 rgba(255, 59, 92, 0); } }

        .progress-container { margin: 10px 0; }
        .progress-text { font-size: 10px; color: var(--text-muted); display: flex; justify-content: space-between; margin-bottom: 4px; }
        .progress-bar { width: 100%; height: 6px; background: var(--border); border-radius: 3px; overflow: hidden; }
        .progress-fill { height: 100%; background: var(--primary); transition: 0.4s; }

        .checklist { margin-top: 5px; background: rgba(0,0,0,0.05); padding: 10px; border-radius: 8px; }
        .check-item { display: flex; align-items: center; gap: 10px; font-size: 12px; margin-bottom: 6px; }
        .check-item input { accent-color: var(--primary); width: 16px; height: 16px; cursor: pointer; }

        .btn-finish { width: 100%; padding: 12px; background: transparent; border: 1px solid var(--border); color: var(--text-muted); border-radius: 6px; font-weight: 800; cursor: pointer; text-transform: uppercase; font-size: 10px; margin-top: auto; }
        .btn-finish:hover { border-color: var(--danger); color: var(--danger); }

        @media print { .nav-bar, .form, .metrics, .btn-finish, .theme-btn { display: none; } .board { grid-template-columns: 1fr; } }
    </style>
</head>
<body class="dark">

    <header>
        <div class="logo-box">
            <div class="logo-sq">RN</div>
            <h1 style="font-size: 20px; font-weight: 800;">ARARAAZUL <span style="color: var(--primary);">PRO ULTRA</span></h1>
        </div>
        <div id="clock" style="font-family: 'DM Mono'; font-weight: 700; color: var(--primary); font-size: 18px;">00:00:00</div>
    </header>

    <nav class="nav-bar">
        <div class="nav-tabs">
            <button id="tab-board" class="t-btn active" onclick="setView('board')">Quadro Visual</button>
            <button id="tab-list" class="t-btn" onclick="setView('list')">Lista Limpa</button>
        </div>
        <div class="nav-tabs">
            <button class="t-btn theme-btn" onclick="document.body.className='light'">Tema Claro</button>
            <button class="t-btn theme-btn" onclick="document.body.className='dark'">Tema Escuro</button>
            <button class="t-btn" style="color: var(--secondary);" onclick="window.print()">Exportar PDF</button>
        </div>
    </nav>

    <div class="metrics">
        <div class="m-card"><span class="m-val" id="m-active">0</span><span class="m-lbl">Pendências Ativas</span></div>
        <div class="m-card"><span class="m-val" id="m-crit" style="color:var(--danger)">0</span><span class="m-lbl">Criticidade ( < 1H )</span></div>
        <div class="m-card"><span class="m-val" id="m-eff" style="color:var(--secondary)">0%</span><span class="m-lbl">Eficiência Global</span></div>
        <div class="m-card"><span class="m-val" id="m-done">0</span><span class="m-lbl">Total Concluído</span></div>
    </div>

    <section class="form">
        <div class="group"><label>PROJETO</label><input type="text" id="in-proj" class="fi" placeholder="EX: FROTA SUL"></div>
        <div class="group"><label>TAREFA</label><input type="text" id="in-task" class="fi" placeholder="DESCRIÇÃO DA DEMANDA"></div>
        <div class="group"><label>EQUIPE</label><input type="text" id="in-team" class="fi" placeholder="ENVOLVIDOS"></div>
        <div class="group"><label>PRAZO E HORA</label><input type="datetime-local" id="in-date" class="fi"></div>
        <div class="group"><label>ETAPAS (VÍRGULA)</label><input type="text" id="in-check" class="fi" placeholder="PASSO 1, PASSO 2"></div>
        <button class="btn-main" onclick="addItem()">Lançar Ultra</button>
    </section>

    <main id="main-board" class="board"></main>

    <script>
        let tasks = JSON.parse(localStorage.getItem('ARARAAZUL_ULTRA_V10')) || [];
        let doneTotal = parseInt(localStorage.getItem('ARARAAZUL_ULTRA_DONE')) || 0;
        let currentView = 'board';

        function setView(v) {
            currentView = v;
            document.querySelectorAll('.t-btn').forEach(b => b.classList.remove('active'));
            document.getElementById('tab-' + v).classList.add('active');
            render();
        }

        function addItem() {
            const proj = document.getElementById('in-proj').value.toUpperCase();
            const task = document.getElementById('in-task').value.toUpperCase();
            const team = document.getElementById('in-team').value.toUpperCase();
            const date = document.getElementById('in-date').value;
            const steps = document.getElementById('in-check').value.toUpperCase();

            if(!proj || !task || !date) return alert("PREENCHA OS CAMPOS OBRIGATÓRIOS.");

            const checklist = steps ? steps.split(',').map(s => ({txt: s.trim(), done: false})) : [];
            tasks.push({ id: Date.now(), proj, task, team, date, checklist });
            save();
            document.getElementById('in-task').value = '';
            document.getElementById('in-check').value = '';
        }

        function toggleStep(taskId, stepIdx) {
            tasks = tasks.map(t => {
                if(t.id === taskId) {
                    t.checklist[stepIdx].done = !t.checklist[stepIdx].done;
                }
                return t;
            });
            save();
        }

        function finish(id) {
            tasks = tasks.filter(t => t.id !== id);
            doneTotal++;
            localStorage.setItem('ARARAAZUL_ULTRA_DONE', doneTotal);
            save();
        }

        function save() {
            localStorage.setItem('ARARAAZUL_ULTRA_V10', JSON.stringify(tasks));
            render();
        }

        function render() {
            const board = document.getElementById('main-board');
            board.className = currentView === 'list' ? 'board list-view' : 'board';
            board.innerHTML = '';
            const now = new Date();
            let crit = 0;

            tasks.sort((a,b) => new Date(a.date) - new Date(b.date)).forEach(t => {
                const deadline = new Date(t.date);
                const diff = deadline - now;
                const isUrgent = diff < 3600000; // MENOS DE 1 HORA
                if(isUrgent) crit++;

                const completedSteps = t.checklist.filter(c => c.done).length;
                const totalSteps = t.checklist.length;
                const progress = totalSteps > 0 ? Math.round((completedSteps / totalSteps) * 100) : 0;

                const leaf = document.createElement('div');
                leaf.className = `leaf ${isUrgent ? 'urgent' : ''}`;
                leaf.innerHTML = `
                    <div style="display:flex; justify-content:space-between; align-items:center;">
                        <span style="font-size:10px; font-weight:900; color:var(--primary)">${t.proj}</span>
                        <span style="font-family:'DM Mono'; font-size:10px; color:${isUrgent ? 'var(--danger)' : 'var(--warning)'}">${diff < 0 ? 'VENCIDO' : 'RESTAM ' + Math.floor(diff/3600000) + 'H'}</span>
                    </div>
                    <h2 class="l-title">${t.task}</h2>
                    <div style="font-size:11px; color:var(--text-muted)">EQUIPE: <b>${t.team}</b></div>
                    <div class="progress-container">
                        <div class="progress-text"><span>PROGRESSO OPERACIONAL</span><span>${progress}%</span></div>
                        <div class="progress-bar"><div class="progress-fill" style="width: ${progress}%"></div></div>
                    </div>
                    <div class="checklist">
                        ${t.checklist.map((c, i) => `
                            <div class="check-item">
                                <input type="checkbox" ${c.done ? 'checked' : ''} onclick="toggleStep(${t.id}, ${i})">
                                <span style="${c.done ? 'text-decoration:line-through; opacity:0.5' : ''}">${c.txt}</span>
                            </div>
                        `).join('')}
                    </div>
                    <button class="btn-finish" onclick="finish(${t.id})">Finalizar Operação</button>
                `;
                board.appendChild(leaf);
            });

            document.getElementById('m-active').innerText = tasks.length;
            document.getElementById('m-crit').innerText = crit;
            document.getElementById('m-done').innerText = doneTotal;
            const efficiency = (doneTotal + tasks.length) > 0 ? Math.round((doneTotal / (doneTotal + tasks.length)) * 100) : 0;
            document.getElementById('m-eff').innerText = efficiency + "%";
        }

        setInterval(() => { document.getElementById('clock').innerText = new Date().toLocaleTimeString('pt-BR'); }, 1000);
        window.onload = render;
    </script>
</body>
</html>

